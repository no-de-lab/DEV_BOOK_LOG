# 분산 시스템을 위한 유일 ID 생성기 설계
분산 환경에서 auto_increment 속성으로 키를 설정하면 안된다. 
DB 서버 한대로는 그 요구를 감당할 수 없고, 여러 데이터베이스 서버를 쓰는 경우 지연 시간을 낮추기가 힘들기 때문이다.

## 유일성이 보장되는 ID 설계
### 1. 다중 마스터 복제
auto_increment 기능을 활용하기는 하는데 다음 id 값을 구할 때 1이 아니라 k만큼 증가시킨다. k는 현재 사용 중인 데이터베이스 서버의 수다. 
이는 여러 데이터 센터에 걸쳐 규모를 늘리기가 어렵고, 해당 값이 시간 흐름에 맞춰 커지도록 보장할 수가 없으며, 서버를 추가하거나 삭제시 잘 동작하기가 어렵다는 단점이 있다.

### 2. UUID
이는 컴퓨터 시스템에 저장되는 정보를 유일하게 식별하기 위한 128비트짜리 수다.

이는 충돌 가능성이 몹시 낮다. 그런데 시간순으로 정렬할수가 없고, 수가 아닌 값이 포함될 수가 없다. 또한 128비트가 아니라 아이디를 64비트로 구성하고 싶다면? 불가하다.

### 3. 티켓 서버
티켓 서버라는 걸 하나 두어, auto_increment 기능을 중앙 집중형으로 하나만 이용한다. 그러나 이는 SPOF가 될 수 있다. 서버에 장애가 발생하면 모든 시스템이 영향을 받는다. 

### 4. 스노우 플레이크 
이는 ID의 구조를 여러 절로 분할한다. 
- 사인 비트: 음/양수 구별
- 타임스탬프 비트
- 데이터 센터 ID
- 서버 ID 
- 일련 번호: 서버에서 아이디를 생성할 때마다 일련번호를 1씩 증가시킨다. 

이는 원하는 아이디 비트를 적절히 부분으로 나눈다. 이 중 데이터 센터와 서버 아이디는 실행 중에 바뀔 수 없다. 

