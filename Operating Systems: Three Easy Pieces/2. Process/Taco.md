OS의 가장 기본적인 추상화 = 프로세스

프로세스의 기본 정의는 사실 심플하다. 돌고있는 프로그램이다. 
OS가 와서 이름을 불러주고서야. 살아있게 된다. 

## 어떻게 여러 개의 프로그램을 돌려볼 수 있을까?
사실 하나의 프로그램만을 돌리고싶은 사람은 없다. 
당연히 여러개를 동시에 하고싶어한다. 그리고 전형적인 시스템은 이를 지원한다. 

많은 CPU가 있는 것도 아닌데, OS는 CPU가 많은 것처럼 보이는 가상화를 이루어낸다. 
하나의 프로세스를 돌리다, 그를 멈추고 다시 하나를 돌리고를 계속한다. 

시분할로 알려진 이 기본적인 기술은, 유저들로 하여금 동시 프로세스를 돌리고 싶은만큼 돌릴 수 있게한다.
아무래도 이렇게 하면 느려지기는 할것이다.

가상화를 잘 이루어내기 위하여, OS는 low-level 매커니즘, 즉 기능을 수행하는 메서드나 프로토콜과 같은 것들과, 그 위에 돌고있는 알고리즘, 즉 스케줄링 정책들이 필요하다. 
이 둘은 잘 분리되어서, 매커니즘은 어떻게 OS가 컨텍스트 스위칭을 할지를, 정책은 어떤 프로세스를 돌릴지를 결정하게 된다.

### The Abstraction: A Process
프로세스라는 것은, OS가 돌아가는 프로그램을 추상한 것이다. 
무엇이 프로세스를 구성하는지 이해하기 위하여, 우리는 그러므로 머신 상태를 이해해야한다.
이 머신 상태의 중요한 부분은, 메모리다. 명령어는 메모리에 있고, 프로세스가 읽고 쓰는 데이터도 메모리에 있다. 그러므로 메모리는 프로세스의 한 부분이다. 
또한 중요한 부분은 레지스터다. 많은 명령어들이 이를 읽고 업데이트한다.

이 레지스터에는 중요한 program counter라는 레지스터가 있다. 이는 다음에 무슨 프로그램을 실행할지를 알려주는 명령어다. 
스택 포인터와 프레임 포인터 레지스터는 지역 변수, 주소, 파라미터 등을 관리한다.

또한, 프로그램들은 storage device에도 접근한다. I/O information과 같은 것은 현재 열려있는 프로세스 리스트를 포함한다. 

#### Process API
- Create: shell에 명령어를 치거나, GUI를 통하면, OS는 새로운 프로세스를 만드는 데 착수한다.
- Destroy: 강제로 프로세스를 종료한다. 
- Wait: 프로세스가 작동을 멈추는 것이 유용할 때가 있다.
- Miscellaneous Control: 프로세스 ㅈ진행을 미루고 재개할 수도 있다. 
- Status: 상태 정보를 파악하는 인터페이스가 있다. 

#### Process Creation: A Little More Detail
어떻게 프로그램이 프로세스로 바뀔까. 
우선, 코드를 메모리 프로세스 공간에 load한다. 처음에는 program들이 disk에 있거나 혹은 flash-based SSD에 있다.
OS는 결국 디스크에 있는 바이트들을 읽고 메모리에 놓는 것이다.

초창기 OS는 프로세스를 한번에 다 읽었고, 최근에는 좀 프로그램 실행 중에 필요할 때만 조금씩 읽는다. 

이렇게 로드된 후, OS가 프로세스 실행 이전에 할 일들이 있다. 
몇 메모리는 프로그램의 런타임스택에 분배가 된다. 이를 arguments와 함께 시작한다. (정적인 데이터에 분배)
또한, OS는 프로그램의 Heap에 몇 메모리를 분배한다. 이는 동적으로 분배된 데이터에 요청되는 것이다. 
그 외에 I/O와 관련된 작업도 진행한다. 

이렇게 모든 사전 작업이 끝나고서야 OS는 프로그램을 실행한다. main()으로 시작해, CPU에게 컨트롤을 맡긴다. 

#### Process States
- Running: processor 위에서 프로세스가 실행된다. 명령어를 수행중이라는 뜻이다.
- Ready: 프로세스는 실행될 준비가 되었지만, 몇 이유로 OS가 잠깐 기다리라고 하는 중이다.
- Blocked: 실행되지 못하게 하는 상태. 예를 들면, 프로세스가 I/O 작업을 실행하면, block된다. 만약 그 이벤트가 끝이나면, 블록된 프로세스는 ready 상태가 된다. 

#### Data Structures
OS 또한 다른 프로그램들처럼 프로그램이다. 그래서, 여러 중요한 자료구조가 있다.
이 자료구조에서, 관련된 정보들을 트래킹한다. 

process list라는, 어떤 프로세스가 ready하고 실행중인지를 트래킹하는 자료구조가 있다. 
각 프로세스들의 상태를 체크할 수 있다. 
그리고 각 프로세스 별로는 PCB라는 것이 있어서, 프로세스의 정보를 포함한다. 


