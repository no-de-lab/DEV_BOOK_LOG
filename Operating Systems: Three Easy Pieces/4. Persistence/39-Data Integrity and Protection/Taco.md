어떻게 스토리지 시스템이나 파일 시스템이 데이터가 안전하다는 것을 보장하는가? 

## 1. Disk Failure Modes
disk는 오류가 날 수도 있고, 완벽하지 않다. 
초기 RAID 시스템에서 실패란, 모든 디스크가 일하고 있거나 모두 fail 했거나다. 
 
현대 디스크는 대부분이 일하는 것 같지만 하나에서 그 이상의 블록을 접근하는 데 문제가 있다. 
- latent-sector errors
- block corruption
이 둘이 싱글 블록 실패에서 자주 보이는 유형이다.

- LSE는 디스크가 상처났을 때 발생한다. 그럼 비트가 읽히지 않는다. 
  - cosmic ray가 비트를 건너 뛸수도 있어서 부정확한 내용을 읽게 되기도 한다. 
- 디스크가 corrupt해서 블록을 틀린 장소에 쓰기할 수도 있다. 
- 이 모두는 잘 일어나지는 않지만, 저렴할수록 더 자주 일어난다. 

## 2. Handling Latent Sector Errors
에러 다루기가 상대적으로 쉽다. 쉽게 파악되기 때문이다. 전체 디스크가 실패하면 RAID는 그를 재건하려고 한다. RAID-4/5에서는 패리티라는 것을 두어서 해당 블록에서 읽어온다. 그런데 만약 재건 중에, LSE가 다른 디스크에게 발견되면 성공적으로 재건이 일어날 수 없다. 
이를 해결하기 위해 몇몇 시스템들은 중복 수준을 추가한다. ex. RAID-DP는 두개의 패리티를 둔다. 

## 3. Detecting Corruption: The Checksum
이 문제는 겉으로 보이지가 않는다. 그래서 찾아내는 게 어렵다. 
일단 발견하면, 회복하면 되지만 발견이 어려우므로, checksum이라는 것을 이용한다. 

- 체크섬은 데이터 청크를 인풋으로 가져가는 함수 결과다. 조금의 결과 내용을 생성한다. 
- 체크섬은 시스템으로 하여금 데이터가 바뀌거나 훼손되었는지 파악할 수 있게한다. 

### Common Checksum Functions
다양한 함수가 체크섬을 계산하는 데 사용된다. 얼마나 데이터 고결성을 보호하면서도 빠른지에 따라 달라진다. 
- 제일 간단한 함수는 XOR
  - 간단하지만 한계가 있다. 
- addition 함수도 있다. 빠르다. 
- fletcher checksum: 안전하다.
- cyclic redundancy check: 가장 많이 사용. 계속해서 수를 나눈다. 나머지가 값이다. 
- 완벽한 체크섬은 없다. 