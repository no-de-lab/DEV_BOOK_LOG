

- OS는 소프트웨어의 몸이다.
프로그램을 실행하고, 같은 시간에 여러 프로그램을 실행하는 것도 허용하고
프로그램이 디바이스와 인터랙트 하고, 메모리 쉐어도 한다.  
> OS는 사용하기 쉬운 방식으로 정확하고 효율적으로 프로그램을 실행하는 중요 역할을 가진다.

- OS를 가상 머신이라고 부른다.
OS가 이를 수행하는 주요 방법은 가상화라고 하는 일반적인 기술을 사용하는 것이다.
즉, OS는 물리적 리소스(프로세서, 메모리, 디스크 등)를 가져와서 보다 일반적이고 강력하며 사용하기 쉬운 가상 형태로 변환
따라서 _운영 체제를 가상 머신_ 이라고 부른다.

- OS가 애플리케이션에 표준 라이브러리를 제공한다(system call)
물론 사용자가 가상 머신의 기능(예: 프로그램 실행, 메모리 할당, 파일 액세스 등)을 활용할 수 있도록 OS는 사용자가 호출할 수 있는 몇 가지 인터페이스(API)도 제공한다.
실제로 일반적인 OS는 애플리케이션에서 사용할 수 있는 _시스템 호출_ 을 내보낸다. 때문에 OS가 애플리케이션에 표준 라이브러리를 제공한다고 말하기도 한다.

- OS를 리소스 관리자라고 부르기도 합니다.
가상화를 통해 많은 프로그램이 실행되고(따라서 CPU 공유), 많은 프로그램이 동시에 자신의 명령어와 데이터에 액세스하고(따라서 메모리 공유), 
많은 프로그램이 장치에 액세스(따라서 디스크 공유 등)할 수 있기 때문에 OS를 리소스 관리자라고 부르기도 한다.
CPU, 메모리, 디스크는 각각 시스템의 리소스이므로 이러한 리소스를 효율적이고 공정하게 관리하거나 다른 여러 가지 가능한 목표를 염두에 두고 관리하는 것이 운영 체제의 역할이다.



## 가상화
### CPU 가상화
OS는 CPU 가상화를 담당한다
> 가상화란, 물리적으로는 하나 밖에 없는 것을 마치 각자 하나씩 있는 것처럼 착각하게 만드는 것
다 수의 프로그램을 한번에 실행함으로 마치 시스템에 다 수의 CPU가 있다고 착각하게 한다. 
그것을 CPU 가상화라고 한다. 

<!-- 참고 -->
https://seamless.tistory.com/2
https://programming-workspace.tistory.com/26


### 메모리 가상화
메모리는 바이트 배열이다. 메모리를 읽으려면 메모리에 저장된 데이터에 액세스할 수 있는 주소를 지정해야 한다
메모리를 쓰기(또는 업데이트)하려면 해당 주소에 기록할 데이터도 지정해야 한다
메모리는 프로그램이 실행 중일 때 항상 접근 가능하다.

프로그램은 모든 데이터 구조를 메모리에 보관하고 다양한 명령어를 통해 접근한다. 
때문에 프로그램의 각 명령어 역시 메모리에 있기에 명령어를 가져 올 때에도 메모리에 접근한다.


동일한 주소에 메모리를 할당 받았지만, 프로그램을 여러 번 실행하면 _프로그램은 각자 독립적으로 값을 업데이트 한다._
이것은 마치 동일한 메모리를 공유하는 것이 아니라, 각자의 전용 메모리를 가지고 있는 것과 같다. -> 이것이 _메모리 가상화_ 이다.

각 프로세스는 _자체의 개인 가상 주소 공간(주소 공간이라고도 함)에 접근_ 하며, _OS는 이를 컴퓨터의 물리적 메모리에 매핑_ 한다.

실행 중인 프로그램 내의 메모리 참조는 다른 프로세스(또는 OS 자체)의 주소 공간에 영향을 미치지 않는다.
-> 실행 중인 프로그램 자체에 관해 물리적 메모리는 모두 그 자체로 존재한다.
그러나 실제로 물리적 메모리는 _운영 체제에서 관리하는 공유 리소스_ 이다.

## 동시성(동시성 문제) 
이 개념은 동일한 프로그램에서 한 번에(즉, 동시에) 많은 작업을 수행할 때 발생하고 해결해야 하는 여러 가지 문제를 지칭하기 위해 사용한다.

OS는 한 프로세스를 먼저 실행한 다음 다른 프로세스를 실행하는 식으로 한 번에 많은 작업을 처리한다.
이 때 프로그램의 명령어들이 원자적으로(한꺼번에) 실행되는 것이 아니라, 한번에 하나씩 실행되는 것 때문에 
동시성 문제가 발생한다. 


## 지속성
시스템 메모리의 경우 DRAM과 같은 장치는 값을 휘발성 방식으로 저장하기 때문에 전원이 꺼지거나 시스템이 충돌하면 메모리의 모든 데이터가 쉽게 손실될 수 있다.
따라서 데이터를 지속적으로 저장할 수 있는 하드웨어와 소프트웨어가 필요하며, 이러한 저장 공간은 모든 시스템에 매우 중요하다.

하드웨어는 일종의 입력/출력 또는 입출력 장치의 형태로 제공된다. (hard drive, SSD)
일반적으로 디스크를 관리하는 운영 체제의 소프트웨어를 _파일 시스템_ 이라고 하며, 
사용자가 생성한 모든 파일을 시스템의 디스크에 안정적이고 효율적인 방식으로 저장하는 역할을 담당합니다.

## Design Goals

정리하면, OS는 아래 3가지 역할을 한다.
- (가상화) 물리적 리소스인 CPU, 메모리를 가상화하고
- (동시성) 동시성과 관련된 문제를 처리하고
- (지속성) 파일을 영구적으로 저장하여 장기적으로 안전하게 보관한다. 
시스템을 구축하려면 몇 가지 목표를 염두에 두고 설계와 구현에 집중하고 필요에 따라 절충점을 찾아야 하며, 적절한 절충점을 찾는 것이 시스템 구축의 핵심입니다.

목표
- 가장 기본적인 목표 중 하나는 시스템을 편리하고 사용하기 쉽게 만들기 위해 _추상화를 구축하는 것_ 이다.
  - 추상화는 CS에서 우리가 하는 모든 일의 기본이다.

- 두번째 목표는 운영 체제를 설계하고 구현하는 데 있어 고성능을 제공하고, OS의 오버헤드를 최소하 하는 것이다.

- 애플리케이션<->애플리케이션, OS<->애플리케이션 간에 보호 기능을 제공하는 것
  - _보호(protection)는 운영 체제의 기본 원칙 중 하나인 격리(isolation)의 핵심_ 이다. 
  - 프로세스를 서로 격리하는 것이 보호의 핵심이며, 따라서 OS가 수행해야 하는 많은 작업의 기반이 됩니다.

- 운영 체제는 중단 없이 실행되어야 한다. 
  운영체제가 중단되면, 시스템에서 실행중인 애플리케이션이 모두 중단된다. 이러한 의존성 때문에 안정성을 제공하는데 목표를 두어야한다.