## 이중화 기술이 필요한 이유
- 끊김없는 좋은 서비스, 안정적인 서비스를 제공하기 위해 꼭 필요하다.
- 동작하지 않을시 전체 시스템의 중단을 초래하는 SPoF를 막아야한다.

인프라의 모든 요소가 이중화 구성이 필요한 항목들이며, 이 요소들이 속한 데이터 센터 자체도 이중화가 필요하다.
-> 인프라의 장애 상황에서 서비스가 가능한 것을 폴트 톨러런스라고 한다.
-> 액티브-액티브 혹은 액티브-스탠바이로 짜고, 모든 용량을 수용 가능하도록 산정해 설계해야한다.


## 이중화 구현을 위한 기술
1. LACP
두개 이상의 물리 인터페이스로 구성된 논리 인터페이스를 이용해, 모든 물리 인터페이스를 액티브 상태로 사용 

액티브-액티브로 구성됨. 물리 인터페이스들의 속도도 동일해야한다.

LACP를 통해 논리 인터페이스를 구성하기 위해 LACPDU 프레임을 사용해야한다.
장비 간 1:1 구성이어야 가능
액티브/패시브 모드가 있음.

PXE는 서버가 운영체제를 설치하기 전 단계라, 운영체제 설치 전에 LACP를 사용할 수 없다는 점을 감안했을 때 인터페이스가 정상적으로 활성화되지 않는다.
일반 인터페이스로 구성해 운영체제 설치 후 > 운영체제에서 LACP 재구성을 해야한다.
이 문제를 해결하기 위해, 스위치가 PXE Boot를 지원하게끔 설정하고, 한쪽이 LACP를 구성하면 PXE Boot 실행, 한쪽만 정상적으로 활성화한 뒤 서버에 운영체제가 설치되면 LACP를 구성한다.

밴더별로 LACP 설정 기술명이 다르다. 윈도 -> 티밍, 리눅스 -> 본딩

2. MC-LAG
SPof를 피하려고 양팔 벌린 구성 즉 서로 다른 스위치로 연결하는데, 이 경우 두 스위치 간 MAC(물리적 주소)주소가 달라서 LACP가 불가능해진다.

근데 서로 다른 스위치 간의 단일 MAC 주소를 사용해 액티브-액티브 형태의 이중화 구성이 가능하다.
가상 맥 주소를 만드는 것이다.

하나의 도메인으로 장비들을 구성하고, 이 둘 사이의 트래픽 전송을 위한 피어링크 구성.
설정 마치면 제어패킷 주고받고, 가상 맥 주소를 동일하게 생성

게이트웨이 이중화
특정한 서브넷에 있는 내부 네트워크가 아닌 외부와 통신할 대는, 라우터의 도움을 받아야한다. 그를 위해서는 게이트웨이 설정이 되어야 하는데, 게이트웨이에 장애가 생긴다면? 
>> 문제가 된다. 그러나
LACP처럼 하나의 IP 주소와 하나의 MAC주소를 동시에 가상으로 알 수 있다면, 문제가 생기더라도 잘 통신할 수 있다는 가정 하에 FHRP라는 게이트웨이 이중화 프로토콜이 만들어졌다.

### 이 경우 실제 IP + 가상 IP를 동일하게 갖는다. 

### FHRP
FHRP는 동일한 그룹 ID를 가지고, 가상 IP를 가진다. 
액티브 장비에 장애가 발생하면 스탠바이 장비가 액티브 역할을 가져온다. MAC 주소 테이블을 갱신한다

-> 이에 대한 표준 프로토콜명은 VRRP다.
VRRP ID + IP를 설정하고, (이 때 Id값은 중복되면 안됨) 액티브/스탠바이 선출을 위한 우선순위 값(기본값 100)을 설정, 이는 헬스체크 후 조건 미달일 경우 우선순위 조절을 위해 설정하는 것.

구성한 뒤, 멀티캐스트로 패킷 보내고, 액티브-스탠바이 선출. 

### 올 액티브 게이트웨이 이중화
액티브-스탠바이의 경우, MC-LAG을 이용한다고 한다면 모든 통신이 액티브 장비를 통해야 하므로, 불필요한 우회가 일어나 비효율적이다. 따라서 MC-LAG의 경우 액티브-액티브 형태로 게이트웨이를 구성한다. 


### 애니캐스트 게이트웨이
애니캐스트 게이트웨이 기술을 적용하면, 여러 게이트웨이에서 동일한 네트워크를 제공해서 한 네트워크가 여러 위치에 위치하도록 디자인 가능하다. 